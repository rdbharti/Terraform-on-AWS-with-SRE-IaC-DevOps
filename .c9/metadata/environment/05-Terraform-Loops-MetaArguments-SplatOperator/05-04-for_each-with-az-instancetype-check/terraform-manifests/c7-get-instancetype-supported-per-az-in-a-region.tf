{"filter":false,"title":"c7-get-instancetype-supported-per-az-in-a-region.tf","tooltip":"/05-Terraform-Loops-MetaArguments-SplatOperator/05-04-for_each-with-az-instancetype-check/terraform-manifests/c7-get-instancetype-supported-per-az-in-a-region.tf","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":77,"column":0},"action":"insert","lines":["# Get List of Availability Zones in a Specific Region","# Region is set in c1-versions.tf in Provider Block","# Datasource-1","data \"aws_availability_zones\" \"my_availabilityzone\" {","  filter {","    name   = \"opt-in-status\"","    values = [\"opt-in-not-required\"]","  }","}","","# Check if that respective Instance Type is supported in that Specific Region in list of availability Zones","# Get the List of Availability Zones in a Particular region where that respective Instance Type is supported","","# Data Source - 2","data \"aws_ec2_instance_type_offerings\" \"my_instance_type\" {","","  for_each = toset(data.aws_availability_zones.my_availabilityzone.names)","  filter {","    name   = \"instance-type\"","    values = [\"t3.micro\"]","  }","","  filter {","    name = \"location\"","    # values = [\"us-east-1a\"]","    values = [each.key]","  }","","  location_type = \"availability-zone\"","}","","","","# Output-1","# Basic Output: All Availability Zones mapped to Supported Instance Types","output \"output_v3_1\" {","    value = {","        for az, details in data.aws_ec2_instance_type_offerings.my_instance_type : az => details.instance_types","    }","}","","","","# Output-2","# Filtered Output: Exclude Unsupported Availability Zones","","output \"output_v3_2\" {","    value = {","        for az, details in data.aws_ec2_instance_type_offerings.my_instance_type : ","        az => details.instance_types if length(details.instance_types) != 0 ","    }","}","","","# Output-3","# Filtered Output: with Keys Function - Which gets keys from a Map","# This will return the list of availability zones supported for a instance type","","output \"output_v3_3\" {","    value = keys ({","        for az, details in data.aws_ec2_instance_type_offerings.my_instance_type : ","        az => details.instance_types if length(details.instance_types) != 0 ","    })","}","","","# Output-4 (additional learning)","# Filtered Output: As the output is list now, get the first item from list (just for learning)","","output \"output_v3_4\" {","    value = keys ({","        for az, details in data.aws_ec2_instance_type_offerings.my_instance_type : ","        az => details.instance_types if length(details.instance_types) != 0 ","    })[0]","}","","",""],"id":1}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":59,"column":12},"end":{"row":62,"column":6},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1665077049530,"hash":"866896a9d1ac879be19b798c6760162f5fd9246b"}